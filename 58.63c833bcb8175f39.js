"use strict";(self.webpackChunkkanban_frontend=self.webpackChunkkanban_frontend||[]).push([[58],{5058:(N,f,n)=>{n.r(f),n.d(f,{ProfileModule:()=>m});var p=n(6895),g=n(4466),a=n(4006),u=n(9197),d=n(610),t=n(4650),h=n(263),b=n(7009),_=n(4859),x=n(3546),c=n(9549),P=n(4144),v=n(3162);function Z(e,o){1&e&&(t.TgZ(0,"span"),t._uU(1,"El nombre de usuario es requerido"),t.qZA())}function C(e,o){1&e&&(t.TgZ(0,"span"),t._uU(1,"El nombre de usuario debe contener al menos 3 caracteres"),t.qZA())}function T(e,o){1&e&&(t.TgZ(0,"span"),t._uU(1,"Debe ingresar un nombre de usuario v\xe1lido"),t.qZA())}function U(e,o){if(1&e&&t.YNc(0,T,2,0,"span",12),2&e){t.oxw();const r=t.MAs(6),i=t.oxw();t.Q6J("ngIf",i.form.controls.username.hasError("whitespace"))("ngIfElse",r)}}function A(e,o){1&e&&(t.TgZ(0,"span"),t._uU(1,"El nombre de usuario solo puede contener las letras a-z y los caracteres -_*."),t.qZA())}function I(e,o){if(1&e&&t.YNc(0,A,2,0,"span",6),2&e){const r=t.oxw(2);t.Q6J("ngIf",r.form.controls.username.hasError("pattern"))}}function M(e,o){if(1&e&&(t.TgZ(0,"mat-error"),t.YNc(1,Z,2,0,"span",6),t.YNc(2,C,2,0,"span",12),t.YNc(3,U,1,2,"ng-template",null,13,t.W1O),t.YNc(5,I,1,1,"ng-template",null,14,t.W1O),t.qZA()),2&e){const r=t.MAs(4),i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.form.controls.username.hasError("required")),t.xp6(1),t.Q6J("ngIf",i.form.controls.username.hasError("minlength"))("ngIfElse",r)}}function J(e,o){1&e&&t._UZ(0,"mat-progress-bar",15)}class l{constructor(o,r,i,O){this.authService=o,this.formBuilder=r,this.snackBar=i,this.router=O,this.loading=!1,this.form=this.formBuilder.group({username:["",[a.kI.required,d.i,a.kI.minLength(3),a.kI.maxLength(24),a.kI.pattern("[\xf1a-zA-Z0-9*_.-]*")]],bio:["",[]]})}ngOnInit(){this.subscription=this.authService.currentUser.subscribe(o=>{this.currentUser=o,this.form.setValue({username:this.currentUser.username||"",bio:this.currentUser.bio||""})})}ngOnDestroy(){this.subscription.unsubscribe()}showMessage(o="Error",r="error"){this.snackBar.open(o,"OK",{panelClass:[`${r}-snackbar`],duration:4e3,horizontalPosition:"center",verticalPosition:"bottom"})}onSubmit(){if(!this.form.pristine){this.loading=!0;const o=this.form.get("username")?.value.replaceAll(" ","-");let r=this.form.get("bio")?.value;r=null===r||0===r.trim().length?null:this.form.get("bio")?.value.trim(),this.authService.updateProfile({username:o,bio:r}).subscribe({next:()=>{this.showMessage("Perfil actualizado","success"),this.loading=!1},error:i=>{this.showMessage(i.message,"error"),this.loading=!1}})}}goBack(){this.router.navigateByUrl("/kanban")}}l.\u0275fac=function(o){return new(o||l)(t.Y36(h.e),t.Y36(a.qu),t.Y36(b.ux),t.Y36(u.F0))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-profile"]],decls:19,vars:5,consts:[[1,"mat-card"],["alt","",3,"src"],[1,"card-container"],[3,"formGroup","ngSubmit"],["color","primary"],["matInput","","formControlName","username","type","text","autocomplete","off"],[4,"ngIf"],["appearance","fill"],["matInput","","rows","3","formControlName","bio"],["mat-raised-button","","color","accent","type","submit",3,"disabled"],["mat-stroked-button","","type","button",3,"click"],["mode","indeterminate",4,"ngIf"],[4,"ngIf","ngIfElse"],["second",""],["third",""],["mode","indeterminate"]],template:function(o,r){1&o&&(t.TgZ(0,"mat-card",0),t._UZ(1,"img",1),t.TgZ(2,"div",2)(3,"form",3),t.NdJ("ngSubmit",function(){return r.onSubmit()}),t.TgZ(4,"mat-form-field",4)(5,"mat-label"),t._uU(6,"Nombre de usuario"),t.qZA(),t._UZ(7,"input",5),t.YNc(8,M,7,3,"mat-error",6),t.qZA(),t.TgZ(9,"mat-form-field",7)(10,"mat-label"),t._uU(11,"Bio"),t.qZA(),t._UZ(12,"textarea",8),t.qZA(),t._UZ(13,"span"),t.TgZ(14,"button",9),t._uU(15," Aceptar "),t.qZA(),t.TgZ(16,"button",10),t.NdJ("click",function(){return r.goBack()}),t._uU(17," Volver "),t.qZA()()(),t.YNc(18,J,1,0,"mat-progress-bar",11),t.qZA()),2&o&&(t.xp6(1),t.Q6J("src",r.currentUser.image,t.LSH),t.xp6(2),t.Q6J("formGroup",r.form),t.xp6(5),t.Q6J("ngIf",!0),t.xp6(6),t.Q6J("disabled",r.form.invalid),t.xp6(4),t.Q6J("ngIf",r.loading))},dependencies:[p.O5,_.lW,x.a8,c.KE,c.hX,c.TO,P.Nt,v.pW,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u],styles:[".mat-card[_ngcontent-%COMP%]{margin:10rem auto;min-width:300px;max-width:600px;background:#212121;position:relative}img[_ngcontent-%COMP%]{background-color:#fff;border-radius:50%;width:140px;height:140px;position:absolute;top:-76px;left:0;right:0;margin-left:auto;margin-right:auto;border:6px solid #212121}form[_ngcontent-%COMP%]{text-align:center}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-bottom:1rem;display:block}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 5px}.card-container[_ngcontent-%COMP%]{padding:6rem 3rem 2rem}"]});const y=[{path:"",component:l}];class s{}s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[u.Bz.forChild(y),u.Bz]});class m{}m.\u0275fac=function(o){return new(o||m)},m.\u0275mod=t.oAB({type:m}),m.\u0275inj=t.cJS({imports:[p.ez,s,g.m,a.UX]})}}]);